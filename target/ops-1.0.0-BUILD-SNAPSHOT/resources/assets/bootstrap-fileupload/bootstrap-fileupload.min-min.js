!function(b){var a=function(c,e){this.$element=b(c),this.type=this.$element.data("uploadtype")||(this.$element.find(".img-thumbnail").length>0?"image":"file"),this.$input=this.$element.find(":file");if(this.$input.length===0){return}this.name=this.$input.attr("name")||e.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),this.$hidden.length===0&&(this.$hidden=b('<input type="hidden" />'),this.$element.prepend(this.$hidden)),this.$preview=this.$element.find(".fileupload-preview");var d=this.$preview.css("height");this.$preview.css("display")!="inline"&&d!="0px"&&d!="none"&&this.$preview.css("line-height",d),this.original={exists:this.$element.hasClass("fileupload-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.$remove=this.$element.find('[data-dismiss="fileupload"]'),this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",b.proxy(this.trigger,this)),this.listen()};a.prototype={listen:function(){this.$input.on("change.fileupload",b.proxy(this.change,this)),b(this.$input[0].form).on("reset.fileupload",b.proxy(this.reset,this)),this.$remove&&this.$remove.on("click.fileupload",b.proxy(this.clear,this))},change:function(h,d){if(d==="clear"){return}var j=h.target.files!==undefined?h.target.files[0]:h.target.value?{name:h.target.value.replace(/^.+\\/,"")}:null;if(!j){this.clear();return}this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);if(this.type==="image"&&this.$preview.length>0&&(typeof j.type!="undefined"?j.type.match("image.*"):j.name.match(/\.(gif|png|jpe?g)$/i))&&typeof FileReader!="undefined"){var g=new FileReader,c=this.$preview,f=this.$element;g.onload=function(i){c.html('<img src="'+i.target.result+'" '+(c.css("max-height")!="none"?'style="max-height: '+c.css("max-height")+';"':"")+" />"),f.addClass("fileupload-exists").removeClass("fileupload-new")},g.readAsDataURL(j)}else{this.$preview.text(j.name),this.$element.addClass("fileupload-exists").removeClass("fileupload-new")}},clear:function(d){this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name","");if(navigator.userAgent.match(/msie/i)){var c=this.$input.clone(!0);this.$input.after(c),this.$input.remove(),this.$input=c}else{this.$input.val("")}this.$preview.html(""),this.$element.addClass("fileupload-new").removeClass("fileupload-exists"),d&&(this.$input.trigger("change",["clear"]),d.preventDefault())},reset:function(c){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.original.exists?this.$element.addClass("fileupload-exists").removeClass("fileupload-new"):this.$element.addClass("fileupload-new").removeClass("fileupload-exists")},trigger:function(c){this.$input.trigger("click"),c.preventDefault()}},b.fn.fileupload=function(c){return this.each(function(){var e=b(this),d=e.data("fileupload");d||e.data("fileupload",d=new a(this,c)),typeof c=="string"&&d[c]()})},b.fn.fileupload.Constructor=a,b(document).on("click.fileupload.data-api",'[data-provides="fileupload"]',function(c){var e=b(this);if(e.data("fileupload")){return}e.fileupload(e.data());var d=b(c.target).closest('[data-dismiss="fileupload"],[data-trigger="fileupload"]');d.length>0&&(d.trigger("click.fileupload"),c.preventDefault())})}(window.jQuery);