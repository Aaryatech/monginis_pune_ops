if(window.google==undefined&&window.google.maps==undefined){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var extend_object=function(b,c){var a;if(b===c){return b}for(a in c){b[a]=c[a]}return b};var replace_object=function(c,b){var a;if(c===b){return c}for(a in b){if(c[a]!=undefined){c[a]=b[a]}}return c};var array_map=function(f,e){var b=Array.prototype.slice.call(arguments,2),d=[],a=f.length,c;if(Array.prototype.map&&f.map===Array.prototype.map){d=Array.prototype.map.call(f,function(g){callback_params=b;callback_params.splice(0,0,g);return e.apply(this,callback_params)})}else{for(c=0;c<a;c++){callback_params=b;callback_params=callback_params.splice(0,0,f[c]);d.push(e.apply(this,callback_params))}}return d};var array_flat=function(c){var b=[],a;for(a=0;a<c.length;a++){b=b.concat(c[a])}return b};var coordsToLatLngs=function(b,c){var d=b[0],a=b[1];if(c){d=b[1];a=b[0]}return new google.maps.LatLng(d,a)};var arrayToLatLng=function(b,c){var a;for(a=0;a<b.length;a++){if(b[a].length>0&&typeof(b[a][0])!="number"){b[a]=arrayToLatLng(b[a],c)}else{b[a]=coordsToLatLngs(b[a],c)}}return b};var getElementById=function(c,b){var a,c=c.replace("#","");if("jQuery" in this&&b){a=$("#"+c,b)[0]}else{a=document.getElementById(c)}return a};var findAbsolutePosition=function(b){var c=0,a=0;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop}while(b=b.offsetParent)}return[c,a]};var GMaps=(function(b){var c=document;var a=function(j){j.zoom=j.zoom||15;j.mapType=j.mapType||"roadmap";var y=this,A,l=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],p=["mousemove","mouseout","mouseover"],r=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],B=j.el||j.div,n=j.markerClusterer,C=google.maps.MapTypeId[j.mapType.toUpperCase()],w=new google.maps.LatLng(j.lat,j.lng),F=j.zoomControl||true,e=j.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},z=e.style||"DEFAULT",f=e.position||"TOP_LEFT",s=j.panControl||true,m=j.mapTypeControl||true,q=j.scaleControl||true,o=j.streetViewControl||true,k=k||true,x={},u={zoom:this.zoom,center:w,mapTypeId:C},d={panControl:s,zoomControl:F,zoomControlOptions:{style:google.maps.ZoomControlStyle[z],position:google.maps.ControlPosition[f]},mapTypeControl:m,scaleControl:q,streetViewControl:o,overviewMapControl:k};if(typeof(j.el)==="string"||typeof(j.div)==="string"){this.el=getElementById(B,j.context)}else{this.el=B}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[y.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=j.zoom;this.registered_events={};this.el.style.width=j.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=j.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=j.enableNewStyle;for(A=0;A<r.length;A++){delete j[r[A]]}if(j.disableDefaultUI!=true){u=extend_object(u,d)}x=extend_object(u,j);for(A=0;A<l.length;A++){delete x[l[A]]}for(A=0;A<p.length;A++){delete x[p[A]]}this.map=new google.maps.Map(this.el,x);if(n){this.markerClusterer=n.apply(this,[this.map])}var t=function(K,P){var O="",T=window.context_menu[y.el.id][K];for(var L in T){if(T.hasOwnProperty(L)){var N=T[L];O+='<li><a id="'+K+"_"+L+'" href="#">'+N.title+"</a></li>"}}if(!getElementById("gmaps_context_menu")){return}var Q=getElementById("gmaps_context_menu");Q.innerHTML=O;var G=Q.getElementsByTagName("a"),S=G.length;L;for(L=0;L<S;L++){var I=G[L];var J=function(i){i.preventDefault();T[this.id.replace(K+"_","")].action.apply(y,[P]);y.hideContextMenu()};google.maps.event.clearListeners(I,"click");google.maps.event.addDomListenerOnce(I,"click",J,false)}var M=findAbsolutePosition.apply(this,[y.el]),H=M[0]+P.pixel.x-15,R=M[1]+P.pixel.y-15;Q.style.left=H+"px";Q.style.top=R+"px";Q.style.display="block"};this.buildContextMenu=function(H,G){if(H==="marker"){G.pixel={};var i=new google.maps.OverlayView();i.setMap(y.map);i.draw=function(){var J=i.getProjection(),I=G.marker.getPosition();G.pixel=J.fromLatLngToContainerPixel(I);t(H,G)}}else{t(H,G)}};this.setContextMenu=function(G){window.context_menu[y.el.id][G.control]={};var I,H=c.createElement("ul");for(I in G.options){if(G.options.hasOwnProperty(I)){var J=G.options[I];window.context_menu[y.el.id][G.control][J.name]={title:J.title,action:J.action}}}H.id="gmaps_context_menu";H.style.display="none";H.style.position="absolute";H.style.minWidth="100px";H.style.background="white";H.style.listStyle="none";H.style.padding="8px";H.style.boxShadow="2px 2px 6px #ccc";c.body.appendChild(H);var K=getElementById("gmaps_context_menu");google.maps.event.addDomListener(K,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){K.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=getElementById("gmaps_context_menu");if(i){i.style.display="none"}};var v=function(G,i){google.maps.event.addListener(G,i,function(H){if(H==undefined){H=this}j[i].apply(this,[H]);y.hideContextMenu()})};for(var D=0;D<l.length;D++){var E=l[D];if(E in j){v(this.map,E)}}for(var D=0;D<p.length;D++){var E=p[D];if(E in j){v(this.map,E)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(j.rightclick){j.rightclick.apply(this,[i])}if(window.context_menu[y.el.id]["map"]!=undefined){y.buildContextMenu("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var I=[],G=this.markers.length,H;for(H=0;H<G;H++){I.push(this.markers[H].getPosition())}this.fitLatLngBounds(I)};this.fitLatLngBounds=function(J){var I=J.length;var H=new google.maps.LatLngBounds();for(var G=0;G<I;G++){H.extend(J[G])}this.map.fitBounds(H)};this.setCenter=function(G,i,H){this.map.panTo(new google.maps.LatLng(G,i));if(H){H()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var h=[],g;for(g in this.map){if(typeof(this.map[g])=="function"&&!this[g]){h.push(g)}}for(A=0;A<h.length;A++){(function(i,H,G){i[G]=function(){return H[G].apply(H,arguments)}})(this,this.map,h[A])}};return a})(this);